$(document).ready(function(){function t(){var t=$(".donate .current-amount .current"),n=$(".donate .current-amount .total");$.ajax({url:"fetchdonations.php",type:"GET",success:function(a){function e(){var n=parseFloat(t.data("amount")+r);n>t.data("total")&&(n=parseFloat(t.data("total"))),t.data("amount",n),t.text(n.toFixed(2)),n<t.data("total")&&setTimeout(function(){e()},s)}t.removeClass("loading"),n.removeClass("loading"),t.text("0.00").data("amount","0.00").data("total",parseFloat(a.totalRaised).toFixed(2)),n.text(a.target);var o=1e3,i=25,s=o/i,r=a.totalRaised/i;e()},error:function(){t.text("-"),n.text("-")}})}$("#map").length>0&&map(),t()});var map=function(){function t(){google.maps.event.addDomListener(window,"load",function(){i=new google.maps.Map($("#map")[0],{center:u.start,zoom:14}),n(),o()})}function n(){a(r.pointsOfInterest),$.each(u,function(t,n){var a=new google.maps.Marker({position:new google.maps.LatLng(n.lat,n.lng),title:n.name});a.setMap(i),r.pointsOfInterest.push(a);var o=new google.maps.InfoWindow({content:n.info});google.maps.event.addListener(a,"click",function(){e(),o.open(i,a),l.push(o)})})}function a(t){$.each(t,function(t,n){n.setMap(null)}),t=[]}function e(){$.each(l,function(t,n){n.close()})}function o(){s=new google.maps.Polyline({strokeColor:"#000000",strokeOpacity:1,strokeWeight:3}),s.setMap(i);var t=s.getPath();$.each(c,function(n,a){t.push(a)})}var i,s,r={pointsOfInterest:[]},l=[],u={start:{name:"Putney Bridge",lat:51.46678,lng:-.213112,info:"START"},finish:{name:"Runnymede Pleasure Ground",lat:51.442137,lng:-.55082,info:"FINISH"}},c=[];t()};